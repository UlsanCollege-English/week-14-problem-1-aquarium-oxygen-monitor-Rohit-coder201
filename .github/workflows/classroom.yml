name: Autograding Tests
'on':
- push
- repository_dispatch
permissions:
  checks: write
  actions: read
  contents: read
jobs:
  run-autograding-tests:
    runs-on: ubuntu-latest
    if: github.actor != 'github-classroom[bot]'
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    - name: tests
      id: tests
      uses: classroom-resources/autograding-python-grader@v1
      with:
        timeout: 10
        setup-command: ''
    - name: Dump tests output for reporter debugging
      run: |
        echo "---- TESTS OUTPUT (truncated 200 lines) ----"
        echo "${{ steps.tests.outputs.result }}" | sed -n '1,200p' || true
        mkdir -p report
        echo "${{ steps.tests.outputs.result }}" > report/tests_result.json || true
      shell: bash
    - name: Upload tests_result artifact
      uses: actions/upload-artifact@v4
      with:
        name: tests-result
        path: report/tests_result.json
    - name: Autograding Reporter
      uses: classroom-resources/autograding-grading-reporter@v1
      env:
        TESTS_RESULTS: "${{steps.tests.outputs.result}}"
      with:
        runners: tests
